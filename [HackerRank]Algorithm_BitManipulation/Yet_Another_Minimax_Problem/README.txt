The complexity is O(N*M) where N+M=N.
Using binary tree may reduce it to O(N+M).